<pf-RPC>
    <script data-fn="load" data-args="relPath, nextLoad">
        window.rpc = this;
        this.initRPC();
        nextLoad();
    </script>

    <script data-fn="initRPC">
        this.__rpc__ = new RPC();

        this.__rpc__.onConnected = (function () {
            if (this.onConnected)
                this.onConnected();
        }).bind(this);

        this.__rpc__.onDisconnected = (function () {
            if (this.onDisconnected)
                this.onDisconnected();
        }).bind(this);

        this.__rpc__.onCalling = (function (obj, method, args, mID) {
            if (this.onCalling)
                this.onCalling(obj, method, args, mID);
        }).bind(this);

        this.__rpc__.onReturn = (function (mID) {
            if (this.onReturn)
                this.onReturn(mID);
        }).bind(this);

        this.__rpc__.onRemoteSignal = (function (obj, sig, args) {
            this.$.trigger("remoteSignal", [obj, sig, args]);
        }).bind(this);

        this.call = this.__rpc__.call.bind(this.__rpc__);
        this.asyncCall = this.__rpc__.asyncCall.bind(this.__rpc__);
    </script>

    <script data-fn="onRemoteSignal" data-args="cb">
        this.$.on("remoteSignal", cb);
    </script>

    <script data-fn="connect" data-args="url, port">
        if (url !== undefined)
            this.__rpc__.url = url;
        if (port !== undefined)
            this.__rpc__.port = port;
        this.__rpc__.connectToHost();
    </script>

    <script data-fn="state">
        return this.__rpc__.ws ? this.__rpc__.ws.readyState : -1;
    </script>
</pf-RPC>
